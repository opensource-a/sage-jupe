import gzip
import os 
import pandas as pd

path='local'
import os
print(os.listdir(path))
for file in os.listdir(path):
    if file.endswith(".gz"):
        print(file)
        f=gzip.open(path+"/"+file,'rb')
        file_content=f.read()
        print(file_content)
        df = pd.read_json(file_content, lines=True)
        print(df)
        line_count=df.shape[0]
        print(line_count)
        i=0
        while (i < line_count):
            df.iloc[[i]].to_csv(path+'/'+df.iloc[i,0]+'.csv', index=None)
            i=i+1
        print("files generated")
